<html>
<head>
<script language="Javascript">
chrome.tabs.onUpdated.addListener(
  function(tabId, changeInfo, tab) 
  {
    if(changeInfo.status == "complete") {
      if(tab.url == "http://www.yahoo.com/") {
        console.log(tab.url);
        chrome.tabs.executeScript(null, 
  {file: "getbm.js"});
      }
    }
  });

chrome.extension.onRequest.addListener(function(request, sender,
                                                callback) {
  if(request.method == 'store') {
  localStorage[request.arg] = request.arg2;
  chrome.windows.create({'url':'http://www.cnn.com/',
   'width':200, 'height':100}, 
  function(newWindow) {
   console.log(newWindow.id);
  });

//  console.log(localStorage['hello']);

  chrome.bookmarks.getTree(function(results) {
  printBookmarks(results);
//   var j;
//  for(var i in results) {
//  console.log(results[0].id + "," + results[0].title);
//  console.log(results[0].children[0].id);
//  if(i.url.matches("yahoo")) {
//  j = i;
//  break;
// }  

//  }


//  chrome.bookmarks.update('367',
//  {'title': "Yahoo - " + localStorage['hello'], 
//  'url': 'www.yahoo.com'});

  });

  callback('');
  } else {
  callback('');
  }
});

function printBookmarks(bookmarks) {
  bookmarks.forEach(function(bookmark) {
    console.debug(bookmark.id + ' - ' + bookmark.title + ' - ' +
  bookmark.url);
    if (bookmark.children)
      printBookmarks(bookmark.children);
  });
}

</script>
</head>
</html>
